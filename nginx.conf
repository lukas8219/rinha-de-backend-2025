# Minimal nginx config for Rinha de Backend load balancing
worker_processes auto;
error_log stderr warn;
pid /tmp/nginx.pid;

events {
    worker_connections 8192;
}

# Stream block for TCP load balancing on port 9999
stream {
    upstream backend {
        server unix:/dev/shm/app1.sock;
        server unix:/dev/shm/app2.sock;
        # Round-robin load balancing (default)
    }

    server {
        listen 9999;
        proxy_pass backend;
        proxy_timeout 2s;
        proxy_connect_timeout 1s;
    }
}
